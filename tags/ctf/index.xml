<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>CTF on hhdx's blog</title><link>https://hhdx.xyz/tags/ctf/</link><description>Recent content in CTF on hhdx's blog</description><generator>Hugo -- gohugo.io</generator><language>en</language><lastBuildDate>Mon, 30 Nov 2020 12:05:03 +0000</lastBuildDate><atom:link href="https://hhdx.xyz/tags/ctf/index.xml" rel="self" type="application/rss+xml"/><item><title>HITB GSEC 2017Ôºöbabyqemu</title><link>https://hhdx.xyz/post/babyqemu/</link><pubDate>Mon, 30 Nov 2020 12:05:03 +0000</pubDate><guid>https://hhdx.xyz/post/babyqemu/</guid><description>&lt;p>È¢òÁõÆ‰∏ãËΩΩÂú∞ÂùÄÔºö&lt;a href="https://github.com/kitctf/writeups/blob/master/hitb-gsec-2017/babyqemu/babyqemu.tar.gz">babyqemu.tar.gz&lt;/a>&lt;/p>
&lt;h2 id="ÂàÜÊûê">ÂàÜÊûê&lt;/h2>
&lt;p>&lt;code>tar xvzf babyqemu.tar.gz&lt;/code>Ëß£ÂéãÁúãÂà∞ÂêØÂä®ËÑöÊú¨&lt;code>launch.sh&lt;/code>&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="cp">#! /bin/sh
&lt;/span>&lt;span class="cp">&lt;/span>./qemu-system-x86_64 &lt;span class="se">\
&lt;/span>&lt;span class="se">&lt;/span>-initrd ./rootfs.cpio &lt;span class="se">\
&lt;/span>&lt;span class="se">&lt;/span>-kernel ./vmlinuz-4.8.0-52-generic &lt;span class="se">\
&lt;/span>&lt;span class="se">&lt;/span>-append &lt;span class="s1">&amp;#39;console=ttyS0 root=/dev/ram oops=panic panic=1&amp;#39;&lt;/span> &lt;span class="se">\
&lt;/span>&lt;span class="se">&lt;/span>-enable-kvm &lt;span class="se">\ &lt;/span> &lt;span class="c1"># ÈúÄË¶ÅCPU virtualizationÔºåÁé∞Âú®‰∏éhyper-vÂÖ±Â≠òÁöÑVMware‰∏çÊîØÊåÅÊ≠§ÈÄâÈ°π„ÄÇÂèØ‰ª•Âà†Êéâ&lt;/span>
-monitor /dev/null &lt;span class="se">\
&lt;/span>&lt;span class="se">&lt;/span>-m 64M --nographic -L ./dependency/usr/local/share/qemu &lt;span class="se">\
&lt;/span>&lt;span class="se">&lt;/span>-L pc-bios &lt;span class="se">\
&lt;/span>&lt;span class="se">&lt;/span>-device hitb,id&lt;span class="o">=&lt;/span>vda
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>Âú®ÊúÄÂêé‰∏ÄË°åÂèØ‰ª•ÁúãÂà∞ËÆæÂ§áÂêçÁß∞‰∏∫hitbÔºåÂú®idaÂ∑¶‰æßFunctions windowÔºåctrl+fÊêúÁ¥¢hitbÂ∞±ÂèØ‰ª•ÊâæÂà∞Áõ∏ÂÖ≥ÂáΩÊï∞„ÄÇÈÄöËøáÂú®idaÁöÑLocal TypesÁ™óÂè£ÊêúÁ¥¢hitbÂèØ‰ª•ÊâæÂà∞&lt;code>HitbState&lt;/code>ÁªìÊûÑ‰ΩìÔºåÂÖ∂‰∏≠ËøòÂåÖÂê´&lt;code>dma_state&lt;/code>ÁªìÊûÑ‰Ωì„ÄÇ&lt;/p></description></item><item><title>Qemu Escape ---- ‰ª•BlizzardCTF2017_STRNG‰∏∫‰æã</title><link>https://hhdx.xyz/post/qemu-pwn/</link><pubDate>Mon, 23 Nov 2020 15:05:17 +0000</pubDate><guid>https://hhdx.xyz/post/qemu-pwn/</guid><description>&lt;p>ÊúÄËøëÊÉ≥Â≠¶‰∏Ä‰∏ãqemu escapeÁöÑÂü∫Á°ÄÁü•ËØÜÔºåËøõËÄåÂàÜÊûê‰∏Ä‰∫õQemuÁöÑCVEÊºèÊ¥û„ÄÇ&lt;/p>
&lt;p>Êú¨Êñá‰∏ªË¶ÅÂèÇËÄÉraycpÂ∏àÂÇÖÁöÑ‰∏§ÁØáÊñáÁ´†„ÄÇ[1] [2]&lt;/p>
&lt;h2 id="qemuÊ¶ÇËø∞">QemuÊ¶ÇËø∞&lt;/h2>
&lt;p>ÊØè‰∏™ËøêË°åÁöÑqemuËôöÊãüÊú∫ÂØπÂ∫î‰∫éhost‰∏äÁöÑ‰∏Ä‰∏™ËøõÁ®ãÔºåËôöÊãüÊú∫ÁöÑÊâßË°åÁ∫øÁ®ãÔºàÂ¶ÇCPUÁ∫øÁ®ã„ÄÅI/OÁ∫øÁ®ãÁ≠âÔºâÂØπÂ∫î‰∫éqemuËøõÁ®ã‰∏≠ÁöÑ‰∏Ä‰∏™Á∫øÁ®ã„ÄÇ&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/clxsh/pics/master/imgqemu-architecture.png" alt="qemu-architecture">&lt;/p>
&lt;p>qemuÁöÑÂÜÖÂ≠òÁªìÊûÑÔºåÊ†πÊçÆ&lt;a href="http://www.phrack.org/papers/vm-escape-qemu-case-study.html">QEMU Case Study&lt;/a>ÔºåËôöÊãüÊú∫ÂØπÂ∫îÁöÑÂÜÖÂ≠òÁªìÊûÑ‰∏∫Â¶Ç‰∏ãÔºö&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback"> Guest&amp;#39; processes
+--------------------+
Virtual addr space | |
+--------------------+
| |
\__ Page Table \__
\ \
| | Guest kernel
+----+--------------------+----------------+
Guest&amp;#39;s phy. memory | | | |
+----+--------------------+----------------+
| |
\__ \__
\ \
| QEMU process |
+----+------------------------------------------+
Virtual addr space | | |
+----+------------------------------------------+
| |
\__ Page Table \__
\ \
| |
+----+-----------------------------------------------++
Physical memory | | ||
+----+-----------------------------------------------++
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div></description></item><item><title>Kernel Pwn: ‰ªéÂÖ•Èó®Âà∞ÂÖ•Âúü</title><link>https://hhdx.xyz/post/kernel-pwn-%E4%BB%8E%E5%85%A5%E9%97%A8%E5%88%B0%E5%85%A5%E5%9C%9F/</link><pubDate>Sun, 25 Oct 2020 19:12:40 +0000</pubDate><guid>https://hhdx.xyz/post/kernel-pwn-%E4%BB%8E%E5%85%A5%E9%97%A8%E5%88%B0%E5%85%A5%E5%9C%9F/</guid><description>&lt;h2 id="misc">MISC&lt;/h2>
&lt;h3 id="ÂÜÖÊ†∏Êñá‰ª∂Âå∫Âà´">ÂÜÖÊ†∏Êñá‰ª∂Âå∫Âà´&lt;/h3>
&lt;p>&lt;code>vmlinux&lt;/code> ÊòØÈùôÊÄÅÈìæÊé•ÁöÑÂèØÊâßË°åÊñá‰ª∂ÔºåÊú™ÂéãÁº©ÁöÑÂÜÖÊ†∏ÔºåÊúÄÂéüÂßãÁöÑÊñá‰ª∂ÔºåÂèØ‰ª•Áî®Êù•Ë∞ÉËØï„ÄÇ&lt;/p>
&lt;p>&lt;code>vmlinuz&lt;/code> ÊòØÂèØÂºïÂØºÁöÑ„ÄÅÂéãÁº©ÁöÑÂÜÖÊ†∏„ÄÇÊ≤°ÊúâË∞ÉËØï‰ø°ÊÅØÁ≠âÊï∞ÊçÆÔºå‰∏çÂèØÁî®‰∫éË∞ÉËØï„ÄÇÂêØÂä®Êó∂‰ºöËá™Ëß£ÂéãÔºåÈÄöÂ∏∏‰ºöÊòæÁ§∫‰ª•‰∏ã‰ø°ÊÅØ&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">Decompressing Linux... done
Booting the kernel.
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;code>zImage&lt;/code> ÊòØÁªèËøáÂéãÁº©ÁöÑÂ∞èÂÜÖÊ†∏ÔºàÂ∞è‰∫é512KBÔºâ„ÄÇ&lt;/p>
&lt;p>&lt;code>bzImage&lt;/code> ÊòØÁªèËøáÂéãÁº©ÁöÑÂ§ßÂÜÖÊ†∏ÔºàÂ§ß‰∫é512KBÔºâ„ÄÇ&lt;/p>
&lt;h3 id="initial-ramdisk">Initial Ramdisk&lt;/h3>
&lt;p>ÂêçÂ≠óÁ±ª‰ºº&lt;code>initramfs.cpio&lt;/code> Êñá‰ª∂Ôºå‰∏ÄËà¨ÂèØ‰ª•‰ΩøÁî®cpioËØªÂèñÂÖ∂‰∏≠ÁöÑÊñá‰ª∂„ÄÇ&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">$ find . &lt;span class="p">|&lt;/span> cpio -o --format&lt;span class="o">=&lt;/span>newc &amp;gt; initramfs.cpio &lt;span class="c1"># compress&lt;/span>
$ sudo cpio -idmv &amp;lt; initramfs.cpio &lt;span class="c1"># depress&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>ÊúâÊó∂‰πüÁªèËøá‰∫ÜgzipÁöÑÂéãÁº©„ÄÇ&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">$ mv initramfs.cpio initramfs.cpio.gz
$ gunzip initramfs.cpio.gz &lt;span class="c1"># Ëß£ÂéãÂæóÂà∞initramfs.cpio&lt;/span>
$ cpio -idmv &amp;lt; initramfs.cpio
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>Êõ¥Êîπ‰∏∫Ê≠£Á°ÆÁöÑÂêéÁºÄ‰πãÂêéÔºåÂõæÂΩ¢ÁïåÈù¢‚ÄúÂΩíÊ°£ÁÆ°ÁêÜÂô®‚Äù‰πüÂèØ‰ª•ÊâìÂºÄ„ÄÇ&lt;/p></description></item><item><title>Arm Pwn</title><link>https://hhdx.xyz/post/arm-pwn/</link><pubDate>Sat, 17 Oct 2020 17:35:26 +0000</pubDate><guid>https://hhdx.xyz/post/arm-pwn/</guid><description>&lt;h2 id="ÁéØÂ¢ÉÈÖçÁΩÆ">ÁéØÂ¢ÉÈÖçÁΩÆ&lt;/h2>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">$ sudo apt install qemu-user gdb-multiarch
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>ÂÆâË£ÖÂÆåÊàêÂêéÂ∞±ÂèØ‰ª•ËøêË°åÂπ≥Âè∞‰∏äÁöÑÈùôÊÄÅÈìæÊé•Êñá‰ª∂‰∫ÜÔºå‰ºöËá™Âä®Ë∞ÉÁî®qemuÊâßË°å„ÄÇ&lt;/p>
&lt;h3 id="Âä®ÊÄÅÈìæÊé•Á®ãÂ∫è">Âä®ÊÄÅÈìæÊé•Á®ãÂ∫è&lt;/h3>
&lt;p>ÂØπ‰∫éÂä®ÊÄÅÈìæÊé•ÁöÑÁ®ãÂ∫èÔºåËøòÈúÄË¶ÅÂÆâË£ÖË∑®Âπ≥Âè∞ÁöÑlib„ÄÇ&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">$ apt-cache search &lt;span class="s2">&amp;#34;libc&amp;#34;&lt;/span> &lt;span class="p">|&lt;/span> grep arm
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>ÂÆâË£ÖÁ±ª‰ººlibc6-ARCH-cross„ÄÇ&lt;/p>
&lt;p>Âä®ÊÄÅÈìæÊé•Â∫ìË¢´ÂÆâË£ÖÂú®Á±ª‰ºº&lt;code>/usr/arm-linux-gnueabihf/&lt;/code>ÁöÑË∑ØÂæÑ„ÄÇqemu‰∏çÁü•ÈÅìÂä®ÊÄÅÈìæÊé•ÁöÑ‰ΩçÁΩÆÔºåÂÆÉÈ¢ÑÊúüÂú®Á±ª‰ºº&lt;code>/etc/qemu-binfmt/arm&lt;/code>ÁöÑË∑ØÂæÑÔºåÊâÄ‰ª•ÂèØ‰ª•ËÆæÁΩÆËΩØÈìæÊé•Êù•ÈÅøÂÖçÁî®&lt;code>-L&lt;/code>Êù•ÊåáÂÆöÈìæÊé•Â∫ì‰ΩçÁΩÆ„ÄÇ&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">$ sudo mkdir /etc/qemu-binfmt
$ sudo ln -s /usr/arm-linux-gnueabihf /etc/qemu-binfmt/arm
$ sudo ln -s /usr/aarch64-linux-gnu/ /etc/qemu-binfmt/aarch64 &lt;span class="c1"># ÂØπ‰∫éaarch64&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div></description></item><item><title>pwnable.tw re-alloc_revenge</title><link>https://hhdx.xyz/post/pwnable-tw-re-alloc-revenge/</link><pubDate>Mon, 07 Sep 2020 14:48:20 +0000</pubDate><guid>https://hhdx.xyz/post/pwnable-tw-re-alloc-revenge/</guid><description>&lt;h2 id="È¢òÁõÆÂàÜÊûê">È¢òÁõÆÂàÜÊûê&lt;/h2>
&lt;p>Èò≤Êä§ÊØî&lt;a href="https://hhdx.xyz/2020/08/07/pwnable-tw-re-alloc/">re-alloc&lt;/a>Â§ö‰∫ÜFULL RELROÂíåPIE„ÄÇÂÖ∂‰ªñÊ≤°ÊúâÊîπÂèò„ÄÇ&lt;/p>
&lt;h2 id="ÊÄª‰ΩìÊÄùË∑Ø">ÊÄª‰ΩìÊÄùË∑Ø&lt;/h2>
&lt;p>Á®ãÂ∫èÊ≤°ÊúâshowÂáΩÊï∞ÔºåÊâÄ‰ª•ÈÄöËøá‰øÆÊîπstdoutÁöÑÊñπÂºèÊ≥ÑÈú≤libc„ÄÇ&lt;/p>
&lt;p>Â∞Ü‰∏Ä‰∏™chunkÂêåÊó∂ÈáäÊîæÂà∞tcacheÂíåunsorted binÔºåpartial overwrite fdÈÉ®ÂàÜÔºåÊåáÂêëstdoutÔºåÈúÄË¶ÅÁàÜÁ†¥4bit„ÄÇÂèñÂæóstdoutÂêé‰øÆÊîπËøõË°åÊ≥ÑÈú≤„ÄÇ&lt;/p>
&lt;p>ÊúÄÂêé‰øÆÊîπ&lt;code>__realloc_hook&lt;/code>‰∏∫one_gadgetÂæóÂà∞shell„ÄÇ&lt;/p>
&lt;p>‰∏ªË¶ÅÈöæÁÇπÂú®Â∏ÉÂ±ÄÊûÑÈÄ†„ÄÇ&lt;/p></description></item><item><title>pwnable.tw tcache_tear seethefile</title><link>https://hhdx.xyz/post/pwnable-tw-tcache-tear-seethefile/</link><pubDate>Wed, 19 Aug 2020 17:26:17 +0000</pubDate><guid>https://hhdx.xyz/post/pwnable-tw-tcache-tear-seethefile/</guid><description>&lt;h1 id="tcache_tear">tcache_tear&lt;/h1>
&lt;h2 id="ÂàÜÊûê">ÂàÜÊûê&lt;/h2>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;span class="lnt">8
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">Arch: amd64-64-little
RELRO: Full RELRO
Stack: Canary found
NX: NX enabled
PIE: No PIE (0x400000)
FORTIFY: Enabled
libc_version: Ubuntu GLIBC 2.27-3ubuntu1
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>Á®ãÂ∫èÂºÄÂßãÂú®bssÊÆµ‰∏äËØªÂÖ•‰∫Ü‰∏Ä‰∏™0x20ÁöÑÂêçÂ≠ó&lt;/p>
&lt;p>malloc: ËæìÂÖ•ÊåáÂÆösizeÔºåÂàÜÈÖçÔºåÊåáÈíàptrÂêåÊ†∑Â≠òÂÇ®Âú®bssÔºåËØªÂÖ•size-16ÁöÑÂ≠óÁ¨¶ÔºåËøôÈáåÂ≠óÁ¨¶‰∏™Êï∞ÂèØ‰ª•Ê∫¢Âá∫&lt;/p>
&lt;p>free: ÈáäÊîæptrÁ©∫Èó¥ÔºåÊåáÈíàÊÇ¨Á©∫ÔºåÂèØ‰ª•double freeÔºåÁ®ãÂ∫è‰ΩøÁî®‰∫ÜtcacheÔºå‰∏îÂú®Ëøô‰∏™ÁâàÊú¨ÈáäÊîæÊ≤°Êúâ‰ªª‰ΩïÁöÑÊ£ÄÊü•&lt;/p>
&lt;p>info: ÊâìÂç∞ÂßìÂêç&lt;/p>
&lt;h2 id="ÊÄª‰ΩìÊÄùË∑Ø">ÊÄª‰ΩìÊÄùË∑Ø&lt;/h2>
&lt;p>Âà©Áî®tcache double freeÔºåÂèØ‰ª•ÂØπ‰ªªÊÑèÂú∞ÂùÄËøõË°åÊîπÂÜô„ÄÇÂú®nameÂ§Ñ‰º™ÈÄ†‰∏Ä‰∏™chunkÈáäÊîæÂà∞unsorted binÔºåËøõË°ålibc baseÁöÑÊ≥ÑÈú≤„ÄÇÂ∞Ü&lt;code>__free_hook&lt;/code>ÊîπÂÜô‰∏∫systemÂú∞ÂùÄ„ÄÇ&lt;/p>
&lt;p>‰º™ÈÄ†chunkÊ≥®ÊÑèÁªïËøáfreeÁöÑÊâÄÊúâÊ£ÄÊü•„ÄÇ‰º™ÈÄ†ÂÆåÊàêÁöÑÁªìÊûÑÂ¶Ç‰∏ãÔºö&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">+----------+
| |
| |
| 0x421 |
| |
+----------+
| 0x21 |
+----------+
| 0x21 |
+----------+
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>tcacheÈªòËÆ§ÊúÄÂ§öÊúâ64‰∏™ÔºåÁ¨¨1‰∏™ÊòØ0x20Â§ßÂ∞èÔºåÈÄíÊé®Á¨¨64‰∏™‰πüÂ∞±ÊòØ0x410„ÄÇÊâÄ‰ª•Â∞ÜnameÂ§Ñ‰º™ÈÄ†‰∏∫0x420Â§ßÂ∞è„ÄÇÁ¨¨‰∏Ä‰∏™chunkÁöÑ&lt;code>chunk-&amp;gt;size=0x420|pre_in_use&lt;/code>ÔºåÈÅøÂÖçbackward consolidateÔºåÁ¨¨‰∏â‰∏™chunkÁöÑ&lt;code>chunk-&amp;gt;size=0x20|pre_in_use&lt;/code>ÔºåÈÅøÂÖçforward consolidate„ÄÇ&lt;/p></description></item><item><title>Á°ÆÂÆöglibcÁâàÊú¨,‰ª•ÊåáÂÆöglibcËøêË°åÁ®ãÂ∫è</title><link>https://hhdx.xyz/post/%E4%BB%A5%E6%8C%87%E5%AE%9Alibc%E8%BF%90%E8%A1%8C%E7%A8%8B%E5%BA%8F/</link><pubDate>Sat, 08 Aug 2020 09:08:15 +0000</pubDate><guid>https://hhdx.xyz/post/%E4%BB%A5%E6%8C%87%E5%AE%9Alibc%E8%BF%90%E8%A1%8C%E7%A8%8B%E5%BA%8F/</guid><description>&lt;h2 id="ÂâçË®Ä">ÂâçË®Ä&lt;/h2>
&lt;p>CTFÈ¢òÁõÆ‰∏≠ÁªèÂ∏∏‰ºöÁªôÂá∫libcÁöÑÊñá‰ª∂ÔºåÈ¶ñÂÖàÈúÄË¶ÅÂÅöÁöÑÂ∞±ÊòØÁ°ÆÂÆölibcÁöÑÁâàÊú¨ÔºåÂØπÁ®ãÂ∫èËøõË°åÈíàÂØπÊÄßÁöÑÊîªÂáª„ÄÇÊúÄÁõ¥Êé•ÁöÑÁ°ÆÂÆöÊñπÊ≥ïÂ∞±ÊòØÁõ¥Êé•ËøêË°åËØ•libc&lt;code>./libc.so.6&lt;/code>Ôºå‰ΩÜÈÄöÂ∏∏Áî±‰∫éÊú¨Êú∫ldÁâàÊú¨‰∏élibcÁâàÊú¨‰∏çÂåπÈÖçÔºåÂèëÁîüÊÆµÈîôËØØ„ÄÇ&lt;/p>
&lt;p>Á°ÆÂÆöÂÆåÂ§ßÁâàÊú¨Âè∑Ëøò‰∏çÂ§üÔºåÂõ†‰∏∫Â∞±ÁÆóÊòØÂêå‰∏ÄÁâàÊú¨ÁöÑlibc‰πü‰ºöÊúâËæÉÂ§ßÁöÑÂèòÂä®„ÄÇÊØîÊñπËØ¥Ôºå‰∏éÊúÄÂºÄÂßãÁöÑ2.29ÁâàÊú¨Áõ∏ÊØîÔºågnu libcÂ∫ìÁöÑrelease/2.29/masterÂàÜÊîØÁöÑ&lt;code>tcache_perthread_struct-&amp;gt;counts&lt;/code>ÁöÑÂèòÈáèÁ±ªÂûãÈÉΩÂèò‰∫ÜÔºõ&lt;code>__libc_malloc&lt;/code>‰∏≠ÂèñÁî®tcacheÁöÑÂà§ÂÆöÔºå‰πüÁî±Âà§Êñ≠ÊåáÈíàÊòØÂê¶‰∏∫Á©∫ÂèòÊàê‰∫ÜÂà§Êñ≠countsÊòØÂê¶Â§ß‰∫é0„ÄÇËøô‰∫õÁªÜËäÇÂæàÂ§ßÁ®ãÂ∫¶‰∏äÂΩ±Âìç‰∫ÜexploitÁöÑ‰π¶ÂÜô„ÄÇ&lt;/p>
&lt;p>‰∏ãÈù¢‰ª•pwnable.tw re-allocÁöÑ&lt;a href="https://github.com/clxsh/ctf_wps/blob/master/pwnable.tw/Re-alloc/libc.so.6">libc&lt;/a>‰∏∫‰æãÔºåÂÜô‰∏ÄÂÜôÊàëÁöÑÁªèÈ™å„ÄÇ&lt;/p></description></item><item><title>pwnable.tw re-alloc</title><link>https://hhdx.xyz/post/pwnable-tw-re-alloc/</link><pubDate>Fri, 07 Aug 2020 22:11:47 +0000</pubDate><guid>https://hhdx.xyz/post/pwnable-tw-re-alloc/</guid><description>&lt;h2 id="È¢òÁõÆÂàÜÊûê">È¢òÁõÆÂàÜÊûê&lt;/h2>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">Arch: amd64-64-little
RELRO: Partial RELRO
Stack: Canary found
NX: NX enabled
PIE: No PIE (0x400000)
FORTIFY: Enabled
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>ÊòØ‰∏Ä‰∏™ÂÖ∏ÂûãÁöÑËèúÂçïÁ±ªÁ®ãÂ∫è&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;span class="lnt">8
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">$$$$$$$$$$$$$$$$$$$$$$$$$$$$
üçä RE Allocator üçä
$$$$$$$$$$$$$$$$$$$$$$$$$$$$
$ 1. Alloc $
$ 2. Realloc $
$ 3. Free $
$ 4. Exit $
$$$$$$$$$$$$$$$$$$$$$$$$$$$
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;ol>
&lt;li>Alloc: indexÂè™ËÉΩÂèñ0Êàñ1ÔºõsizeÂøÖÈ°ª&amp;lt;=0x78ÔºõÁÑ∂Âêé‰ΩøÁî®&lt;code>realloc(0, size)&lt;/code>ÂàÜÈÖçÔºåÈÄöËøáÊ∫êÁ†ÅÂèØ‰ª•ÁúãÂá∫ÔºåËøôÂ∞±Áõ∏ÂΩì‰∫é&lt;code>malloc(size)&lt;/code>„ÄÇËøôÈáåÂ≠òÂú®null byte overflowÔºàÁÑ∂ËÄåÊ≤°‰ªÄ‰πàÁî®‰ºº‰πéÔºå‰∏ÄÂºÄÂßãÊàë‰∏ÄÁõ¥Âç°Âú®ËøôÈáåÊÉ≥Â¶Ç‰ΩïÂà©Áî®ÔºåÂÆåÂÖ®Ê≤°Ê≥®ÊÑèÂà∞Âêé‰∏Ä‰∏™ÊºèÊ¥û„ÄÇ„ÄÇ„ÄÇ&lt;/li>
&lt;/ol>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-c" data-lang="c">&lt;span class="cm">/* realloc of null is supposed to be same as malloc */&lt;/span>
&lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">oldmem&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="k">return&lt;/span> &lt;span class="n">__libc_malloc&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">bytes&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;ol start="2">
&lt;li>Realloc: sizeÂêåÊ†∑&amp;lt;=0x78„ÄÇreallocÊúâÂá†ÁßçÊÉÖÂÜµÔºöËØ∑Ê±ÇÂ§ßÂ∞èËá™Â∑±ÂèØ‰ª•Êª°Ë∂≥ÔºõÂ∞ùËØïÂêëÂêéÊâ©Â±ï(top chunkÊàñ!inuse (next))Ôºõ&lt;code>__int_malloc&lt;/code>ËØ∑Ê±ÇÊñ∞Âùó„ÄÇÔºàËøôÈáåÂ≠òÂú®UAFÔºåËæìÂÖ•size‰∏∫0&lt;/li>
&lt;li>FreeÔºö&lt;code>realloc(ptr, 0)&lt;/code>Áõ∏ÂΩì‰∫é&lt;code>free(ptr)&lt;/code>ÔºåÂêåÊó∂Â∞ÜÊåáÈíàÊï∞ÁªÑÁΩÆÁ©∫„ÄÇ&lt;/li>
&lt;/ol>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-c" data-lang="c">&lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">bytes&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="mi">0&lt;/span> &lt;span class="o">&amp;amp;&amp;amp;&lt;/span> &lt;span class="n">oldmem&lt;/span> &lt;span class="o">!=&lt;/span> &lt;span class="nb">NULL&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="p">{&lt;/span>
&lt;span class="n">__libc_free&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">oldmem&lt;/span>&lt;span class="p">);&lt;/span> &lt;span class="k">return&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">;&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>libc_version: glibc 2.29 with tcache„ÄÇËØ•ÁâàÊú¨libcÁöÑ&lt;a href="https://launchpad.net/ubuntu/+source/glibc/2.29-0ubuntu2">Ê∫êÁ†Å&lt;/a>„ÄÇ‰∏ã‰∏ÄÁØáÊñáÁ´†ËØ¥‰∏Ä‰∏ãÂ¶Ç‰ΩïÁ°ÆÂÆöÁöÑlibcÁâàÊú¨ÔºåÂ¶Ç‰ΩïÁ°ÆÂÆöÁöÑÊúâtcacheÔºå‰ª•ÂèäÂ¶Ç‰Ωï‰ΩøÁî®ÊåáÂÆölibcËøêË°åÁ®ãÂ∫è„ÄÇ&lt;/p>
&lt;p>Ê≠§Â§ñÔºåËøô‰∏™ÁâàÊú¨‰∏≠Âá∫Áé∞‰∫ÜÂØπtcache double freeÁöÑ‰∏Ä‰∏™&lt;a href="https://hhdx.xyz/2020/08/01/How2heap%E6%80%BB%E7%BB%93/#fastbin-dup">Ê£ÄÊü•Êú∫Âà∂&lt;/a>„ÄÇ&lt;/p></description></item><item><title>How2heapÊÄªÁªì</title><link>https://hhdx.xyz/post/how2heap%E6%80%BB%E7%BB%93/</link><pubDate>Sat, 01 Aug 2020 19:36:10 +0000</pubDate><guid>https://hhdx.xyz/post/how2heap%E6%80%BB%E7%BB%93/</guid><description>&lt;h2 id="first-fit">first-fit&lt;/h2>
&lt;p>Â¶ÇÊûú‰∏Ä‰∏™chunkÂèØÁî®‰∏îË∂≥Â§üÂ§ßÔºåÈÇ£‰πàÂ∞±‰ºö‰ΩøÁî®Ëøô‰∏™chunk„ÄÇ&lt;/p>
&lt;h2 id="calc_tcache_idx">calc_tcache_idx&lt;/h2>
&lt;p>tcache(thread local caching)&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-c" data-lang="c">&lt;span class="cm">/* We want 64 entries. This is an arbitrary limit, which tunables can reduce. */&lt;/span>
&lt;span class="cp"># define TCACHE_MAX_BINS 64
&lt;/span>&lt;span class="cp"># define MAX_TCACHE_SIZE tidx2usize (TCACHE_MAX_BINS-1)
&lt;/span>&lt;span class="cp">&lt;/span>
&lt;span class="cm">/* Only used to pre-fill the tunables. */&lt;/span>
&lt;span class="cp"># define tidx2usize(idx) (((size_t) idx) * MALLOC_ALIGNMENT + MINSIZE - SIZE_SZ)
&lt;/span>&lt;span class="cp">&lt;/span>
&lt;span class="cm">/* When &amp;#34;x&amp;#34; is from chunksize(). */&lt;/span>
&lt;span class="cp"># define csize2tidx(x) (((x) - MINSIZE + MALLOC_ALIGNMENT - 1) / MALLOC_ALIGNMENT)
&lt;/span>&lt;span class="cp">&lt;/span>&lt;span class="cm">/* When &amp;#34;x&amp;#34; is a user-provided size. */&lt;/span>
&lt;span class="cp"># define usize2tidx(x) csize2tidx (request2size (x))
&lt;/span>&lt;span class="cp">&lt;/span>
&lt;span class="cm">/* With rounding and alignment, the bins are...
&lt;/span>&lt;span class="cm"> idx 0 bytes 0..24 (64-bit) or 0..12 (32-bit)
&lt;/span>&lt;span class="cm"> idx 1 bytes 25..40 or 13..20
&lt;/span>&lt;span class="cm"> idx 2 bytes 41..56 or 21..28
&lt;/span>&lt;span class="cm"> etc. */&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>tcacheÊã•ÊúâÂíåfastbinÂ∑Æ‰∏çÂ§öÁöÑÁªìÊûÑ„ÄÇÈªòËÆ§ÊÉÖÂÜµ‰∏ãÔºå64‰∏™binÔºåÊØè‰∏™binÊúÄÂ§ö7‰∏™chunk&lt;/p>
&lt;p>64bit: &lt;code>IDX = (CHUNKSIZE - 0x11) / 0x10&lt;/code>&lt;/p></description></item><item><title>How2heap--tcache_stashing_unlink_attack Hitcon2019--one_punch</title><link>https://hhdx.xyz/post/how2heap-tcache-stashing-unlink-attack-hitcon2019-one-punch/</link><pubDate>Fri, 31 Jul 2020 21:40:45 +0000</pubDate><guid>https://hhdx.xyz/post/how2heap-tcache-stashing-unlink-attack-hitcon2019-one-punch/</guid><description>&lt;h2 id="tcache-stashing-unlink-attack">tcache stashing unlink attack&lt;/h2>
&lt;p>Âú®tcache‰∏≠Â∏ÉÁΩÆ5‰∏™chunkÔºåÂØπÂ∫îÂ§ßÂ∞èÁöÑsmall bin‰∏≠Â∏ÉÁΩÆ2‰∏™chunk„ÄÇ‰øÆÊîπÂÄíÊï∞Á¨¨‰∫å‰∏™small chunkÁöÑbkÊåáÂêëtargetÔºåtarget-&amp;gt;bkÂÜôÂÖ•‰∏Ä‰∏™ÂèØÂÜôÁöÑ‰ΩçÁΩÆ„ÄÇ‰ΩøÁî®callocËß¶ÂèëÔºåÂõ†‰∏∫callocË∞ÉÁî®&lt;code>_int_malloc&lt;/code>‰∏ç‰ºö‰ΩøÁî®tcacheËøõË°åÂàÜÈÖçÔºàÈô§‰∫Ü&lt;code>_int_malloc&lt;/code>ÈÅçÂéÜunsorted binÁöÑÂ∞æÈÉ®ÔºâÔºåÂè™‰ºöÂæÄtcache‰∏≠Â°´ÂÖÖ„ÄÇ&lt;/p>
&lt;p>ÂèØ‰ª•ÈÄ†Êàêtarget-&amp;gt;bk-&amp;gt;fd‰ΩçÁΩÆÂÜôÂÖ•Â§ßÊï∞Â≠óÔºåÂπ∂‰∏îtargetÊàê‰∏∫tcache‰∏≠Á¨¨‰∏Ä‰∏™ÔºåÂÜçÊ¨°mallocÂ∞±ÂèØ‰ª•Ëé∑Âæó„ÄÇ&lt;/p>
&lt;p>ÊúâÁÇπÂÉèfastbin reverse into tcache„ÄÇ&lt;/p>
&lt;h3 id="variation">variation&lt;/h3>
&lt;p>Âú®tcache‰∏≠Â∏ÉÁΩÆ6‰∏™chunkÔºåÂØπÂ∫îÂ§ßÂ∞èÁöÑsmall bin‰∏≠Â∏ÉÁΩÆ2‰∏™chunk„ÄÇÔºàÂèØ‰ª•Áî®unsorted binÂàáÂâ≤ÁöÑÊñπÂºèÂ∏ÉÁΩÆ2‰∏™small binÔºâ&lt;/p>
&lt;p>‰øÆÊîπÂÄíÊï∞Á¨¨‰∫å‰∏™small chunkÁöÑbkÔºåcallocËß¶ÂèëÔºåÂè™Âú®bk-&amp;gt;fdÂÜôÂÖ•Â§ßÊï∞Â≠ó„ÄÇ&lt;/p></description></item><item><title>How2heap--house_of_orange Hitcon2016--houseoforange</title><link>https://hhdx.xyz/post/how2heap-house-of-orange-hitcon2016-houseoforange/</link><pubDate>Sat, 25 Jul 2020 18:14:07 +0000</pubDate><guid>https://hhdx.xyz/post/how2heap-house-of-orange-hitcon2016-houseoforange/</guid><description>&lt;h2 id="house-of-orange">house of orange&lt;/h2>
&lt;p>‰øÆÊîπ&lt;code>topchunk-&amp;gt;size&lt;/code>‰∏∫‰∏Ä‰∏™Áº©Â∞èÁöÑÂπ∂‰∏îÊª°Ë∂≥È°µÂØπÈΩêÁöÑÂ§ßÂ∞èÔºåmalloc‰∏Ä‰∏™Â§ß‰∫ésizeÁöÑÂùóÔºà‰ΩÜ‰πü‰∏çË¶ÅÂ§ß‰∫émmap thresholdÔºâÔºå‰ºöÂØºËá¥ÂéüÊù•topchunkË¢´ÊîæÂÖ•unsorted bin„ÄÇ&lt;/p>
&lt;p>ÂΩìtopchunk‰∏çË∂≥‰ª•ÂàÜÈÖçÊâÄÈúÄÁ©∫Èó¥Êó∂Ôºå‰ºöË∞ÉÁî®sysmallocÂàÜÈÖçÈ¢ùÂ§ñÁ©∫Èó¥„ÄÇ‰∏ÄËà¨ÊÉÖÂÜµ‰∏ãÔºåmain_arena‰∏≠old top chunkÂíåÊñ∞ÂàÜÈÖçÁöÑtop chunkÈ¶ñÂ∞æÁõ∏ÈÇªÔºå‰ªéËÄå‰ºöËøõË°åÂêàÂπ∂„ÄÇÂΩìÊàë‰ª¨Â∞Ü&lt;code>topchunk-&amp;gt;size&lt;/code>ÂáèÂ∞èÂêéÔºå‰ºöÊ£ÄÊµã‰∏çÂà∞Áõ∏ÈÇªÔºå‰πüÂ∞±‰∏ç‰ºöÂêàÂπ∂‰∫Ü„ÄÇËÆæÁΩÆÂ•Ωfencepost chunkÔºå‰ºöÊâßË°å&lt;code>_int_free (av, old_top, 1)&lt;/code>Â∞ÜÂÖ∂ÊîæÂÖ•unsorted bin„ÄÇ&lt;/p>
&lt;p>‰ª£Á†ÅÊ∂âÂèä&lt;code>_int_malloc&lt;/code>ÂêéËæπÂíå&lt;code>sysmalloc&lt;/code>„ÄÇ&lt;/p></description></item><item><title>How2heap--house_of_einherjar SECON2016--tinypad</title><link>https://hhdx.xyz/post/how2heap-house-of-einherjar-secon2016-tinypad/</link><pubDate>Thu, 23 Jul 2020 09:57:08 +0000</pubDate><guid>https://hhdx.xyz/post/how2heap-house-of-einherjar-secon2016-tinypad/</guid><description>&lt;h2 id="house-of-einherjar">house of einherjar&lt;/h2>
&lt;p>Âíåhouse of forceÂæàÂÉèÔºåÈÉΩÊòØÁØ°Êîπtop chunk„ÄÇ&lt;/p>
&lt;p>off-by-oneË¶ÜÁõñvictim chunkÁöÑ&lt;code>pre_in_use&lt;/code>‰ΩçÔºåÂπ∂‰øÆÊîπ&lt;code>victim-&amp;gt;pre_size&lt;/code>‰∏∫Ë∑ùÁ¶ªÁõÆÊ†áÂú∞ÂùÄÁöÑÂ§ßÂ∞èÔºåÂú®ÁõÆÊ†áÂú∞ÂùÄÂ§Ñ‰º™ÈÄ†chunkÔºåÈáäÊîævictimÊó∂ÔºåÂèëÁîübackward consolidateÔºåÂêàÂπ∂Âà∞ÁõÆÊ†áÂú∞ÂùÄ„ÄÇ&lt;/p>
&lt;p>&lt;strong>victimÈúÄË¶Å‰∏¥Ëøëtop chunk&lt;/strong>Ôºåbackward consolidateÁªìÊùüÔºåÊé•ÁùÄ‰∏étop chunkËøõË°åforward consolidate„ÄÇÂ¶ÇÊûú‰∏çËøôÊ†∑ÔºåËøô‰∏™ÂùóË¢´ÊîæÂÖ•unsorted binÔºåËÄåÂú®unsorted bin‰∏≠ÂàÜÈÖç‰ºöËøá‰∏ç‰∫Ü‰ª•‰∏ãÊ£ÄÊü•„ÄÇ&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-c" data-lang="c">&lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">__builtin_expect&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">chunksize_nomask&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">victim&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">&amp;lt;=&lt;/span> &lt;span class="mi">2&lt;/span> &lt;span class="o">*&lt;/span> &lt;span class="n">SIZE_SZ&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="o">||&lt;/span> &lt;span class="n">__builtin_expect&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">chunksize_nomask&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">victim&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="o">&amp;gt;&lt;/span> &lt;span class="n">av&lt;/span>&lt;span class="o">-&amp;gt;&lt;/span>&lt;span class="n">system_mem&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">))&lt;/span>
&lt;span class="n">malloc_printerr&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;malloc(): memory corruption&amp;#34;&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div></description></item><item><title>How2heap--large_bin_attack 0ctf2018--heapstorm2</title><link>https://hhdx.xyz/post/how2heap-large-bin-attack-0ctf2018-heapstorm2/</link><pubDate>Sat, 18 Jul 2020 21:10:54 +0000</pubDate><guid>https://hhdx.xyz/post/how2heap-large-bin-attack-0ctf2018-heapstorm2/</guid><description>&lt;h2 id="large-bin-attack">large bin attack&lt;/h2>
&lt;p>ÂØπÂ∑≤Â≠òÂú®‰∫élarge bin‰∏≠ÁöÑchunkÁöÑbk„ÄÅbk_nextsizeÂ≠óÊÆµËøõË°åÊõ¥ÊîπÔºåÂú®unsorted bin‰∏≠ÂèñÂá∫ÊèíÂÖ•ËØ•large binÊó∂Ôºå‰ºöÂ∞Übk-&amp;gt;fd„ÄÅbk_nextsize-&amp;gt;fd_nextsizeÁöÑ‰ΩçÁΩÆË¶ÜÁõñÊàêchunkÁöÑÂú∞ÂùÄ„ÄÇÊ∂âÂèäÁöÑ‰ª£Á†ÅÂ∞±ÊòØunsorted binÈÅçÂéÜÂèñÂá∫ÊèíÂÖ•ÈÇ£Âùó„ÄÇÂíåÂÖàÂâçÁöÑunsorted bin attackÁ±ª‰ººÔºåÈÄöÂ∏∏‰∏∫Ëøõ‰∏ÄÊ≠•ÊîªÂáªÂÅöÂáÜÂ§áÔºåÂ¶Ç‰øÆÊîπglobal_max_fast„ÄÇ&lt;/p>
&lt;p>ËøôÈáåÊØîËæÉÈöæÁêÜËß£Â∞±ÊòØlarge binÁöÑÁªìÊûÑÔºåÁâπÂà´ÊòØÂÖàÂâçÊàëË¢´‰∏Ä‰∏™&lt;a href="https://raw.githubusercontent.com/clxsh/pics/master/img/largebin.png">large binÁªìÊûÑÂõæ&lt;/a>ÊâÄËØØÂØºÔºå‰∏ãÈù¢ÁªôÂá∫ÊàëÁîªÁöÑÁªìÊûÑÂõæÔºàÂ¶ÇÊûúÊúâÈîôËØØo((‚äôÔπè‚äô))oÔºåËØ∑Â∏ÆÂøôÊåáÂá∫Ôºâ„ÄÇ&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/clxsh/pics/master/img/large_bin2.png" alt="glibc large bin">&lt;/p>
&lt;h2 id="0ctf2018-heapstorm2">0ctf2018 heapstorm2&lt;/h2>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">Arch: amd64-64-little
RELRO: Full RELRO
Stack: Canary found
NX: NX enabled
PIE: PIE enabled
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="ÂäüËÉΩÂàÜÊûê">ÂäüËÉΩÂàÜÊûê&lt;/h3>
&lt;p>Á®ãÂ∫èÈ¶ñÂÖà‰ΩøÁî®malloptÂáΩÊï∞Â∞Üglobal_max_fastËÆæÁΩÆ‰∏∫0Ôºå‰πüÂ∞±ÊòØ‰∏ç‰ΩøÁî®fastbin„ÄÇ&lt;/p></description></item><item><title>How2heap--unsorted_bin_attack 0ctf2016--zerostorage</title><link>https://hhdx.xyz/post/how2heap-unsorted-bin-attack-0ctf2016-zerostorage/</link><pubDate>Sun, 12 Jul 2020 10:01:35 +0000</pubDate><guid>https://hhdx.xyz/post/how2heap-unsorted-bin-attack-0ctf2016-zerostorage/</guid><description>&lt;h2 id="unsorted-bin-attack">unsorted bin attack&lt;/h2>
&lt;p>ÂØπunsorted bin‰∏≠ÁöÑ&lt;code>chunk-&amp;gt;bk&lt;/code>ËøõË°å‰øÆÊîπÔºåÊé•‰∏ãÊù•ËØ•chunkÂàÜÈÖçÂá∫ÂéªÊó∂Ôºå&lt;code>chunk-&amp;gt;bk-&amp;gt;fd&lt;/code>Â∞±Ë¢´ËµãÂÄº‰∏∫unsortedbinÂ§¥ÁªìÁÇπÂú∞ÂùÄ„ÄÇ&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-c" data-lang="c">&lt;span class="n">bck&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">victim&lt;/span>&lt;span class="o">-&amp;gt;&lt;/span>&lt;span class="n">bk&lt;/span>&lt;span class="p">;&lt;/span>
&lt;span class="cm">/* remove from unsorted list */&lt;/span>
&lt;span class="n">unsorted_chunks&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">av&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">-&amp;gt;&lt;/span>&lt;span class="n">bk&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">bck&lt;/span>&lt;span class="p">;&lt;/span>
&lt;span class="n">bck&lt;/span>&lt;span class="o">-&amp;gt;&lt;/span>&lt;span class="n">fd&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">unsorted_chunks&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">av&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>Âú®glibc2.28‰∏≠Â¢ûÂä†‰∫Ü‰ª•‰∏ãÊ£ÄÊü•Ôºå‰ΩøÂæóÊ≠§ÊîªÂáªÂ§±Êïà„ÄÇ&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-c" data-lang="c">&lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">__glibc_unlikely&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">bck&lt;/span>&lt;span class="o">-&amp;gt;&lt;/span>&lt;span class="n">fd&lt;/span> &lt;span class="o">!=&lt;/span> &lt;span class="n">victim&lt;/span>&lt;span class="p">))&lt;/span>
&lt;span class="n">malloc_printerr&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;malloc(): corrupted unsorted chunks 3&amp;#34;&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>unsorted bin attackÈÄöÂ∏∏‰∏∫Ëøõ‰∏ÄÊ≠•ÁöÑÊîªÂáªÂÅöÂáÜÂ§áÔºåÊØîÂ¶ÇË¶ÜÂÜôglobal_max_fast„ÄÇ&lt;/p>
&lt;h2 id="0ctf2016-zerostorage">0ctf2016 zerostorage&lt;/h2>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">Arch: amd64-64-little
RELRO: Full RELRO
Stack: Canary found
NX: NX enabled
PIE: PIE enabled
FORTIFY: Enabled
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>ÂÖ≥ÈîÆÊï∞ÊçÆÁªìÊûÑ&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/clxsh/pics/master/img/image-20200712102723178.png" alt="image-20200712102723178">&lt;/p>
&lt;p>flagÔºöÊ†áËØÜËØ•ËäÇÁÇπÊòØÂê¶Â≠òÂú®&lt;/p>
&lt;p>sizeÔºöËÆ∞ÂΩïÂ§ßÂ∞è&lt;/p>
&lt;p>contentÔºöÊï∞ÊçÆÂùóÊåáÈíà&lt;/p>
&lt;p>Á®ãÂ∫èÊúâ‰ª•‰∏ãÂäüËÉΩ&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">1. Insert
2. Update
3. Merge
4. Delete
5. View
6. List
7. Exit
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>insertÔºöËé∑ÂèñÊï∞ÊçÆÂùóÂ§ßÂ∞èÔºåÂπ∂ËØªÂÖ•Êï∞ÊçÆ„ÄÇÊï∞ÊçÆÂùóÂ§ßÂ∞èÂú®128~4096Ëøô‰∏™ËåÉÂõ¥ÂÜÖ&lt;/p>
&lt;p>updateÔºöÂØπÊï∞ÊçÆÂùóËøõË°åÂ§ßÂ∞èÂÜÖÂÆπËøõË°åÊõ¥Êñ∞&lt;/p>
&lt;p>mergeÔºöÂ∞Ü‰∏§ËäÇÁÇπÂêàÂπ∂„ÄÇËøôÈáåÂ≠òÂú®ÊºèÊ¥ûÔºåËæìÂÖ•‰∏§Ê¨°Áõ∏ÂêåÁöÑidÔºåÂØºËá¥UAF„ÄÇËøô‰∏™ÊºèÊ¥ûÊàëÊ≤°ÂèëÁé∞ÔºåÊÄùÁª¥Ëøò‰∏çÂ§üÁå•ÁêêÂïä&lt;/p>
&lt;p>deleteÔºöÈáäÊîæÊï∞ÊçÆÂùóÔºåÊ∏ÖÁ©∫ËäÇÁÇπ&lt;/p>
&lt;h3 id="ÊÄª‰ΩìÊÄùË∑Ø">ÊÄª‰ΩìÊÄùË∑Ø&lt;/h3>
&lt;p>ÈÄöËøáUAFÔºåÈ¶ñÂÖàÊ≥ÑÈú≤libcÂü∫ÂùÄÔºåÁÑ∂Âêé‰øÆÊîπÂÖ∂bkÊåáÈíàÔºå‰ΩøÁî®unsorted bin attack‰øÆÊîπglobal_max_fastÂèòÈáèÔºõfastbin bin attackË¶ÜÂÜô&lt;code>__free_hook&lt;/code>‰∏∫systemÂáΩÊï∞Âú∞ÂùÄ„ÄÇ&lt;/p></description></item><item><title>How2heap--house_of_force Bctf2016--bcloud</title><link>https://hhdx.xyz/post/how2heap-house-of-force-bctf2016-bcloud/</link><pubDate>Tue, 07 Jul 2020 14:46:39 +0000</pubDate><guid>https://hhdx.xyz/post/how2heap-house-of-force-bctf2016-bcloud/</guid><description>&lt;h2 id="house-of-force">House of force&lt;/h2>
&lt;p>Ê∫¢Âá∫‰øÆÊîπtopchunkÁöÑsizeÔºåÂàÜÈÖç‰∏Ä‰∏™‰Ωøsize_tÊ∫¢Âá∫ÁöÑevil_sizeÔºå‰Ωø‰∏ã‰∏ÄÊ¨°ÂàÜÈÖçÂú®ÁõÆÊ†á‰ΩçÁΩÆÔºåËøõË°å‰øÆÊîπ„ÄÇ&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;span class="lnt">6
&lt;/span>&lt;span class="lnt">7
&lt;/span>&lt;span class="lnt">8
&lt;/span>&lt;span class="lnt">9
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-c" data-lang="c">&lt;span class="cm">/*
&lt;/span>&lt;span class="cm">* The evil_size is calulcated as (nb is the number of bytes requested + space for metadata):
&lt;/span>&lt;span class="cm">* new_top = old_top + nb
&lt;/span>&lt;span class="cm">* nb = new_top - old_top
&lt;/span>&lt;span class="cm">* req + 2sizeof(long) = new_top - old_top
&lt;/span>&lt;span class="cm">* req = new_top - old_top - 2sizeof(long)
&lt;/span>&lt;span class="cm">* req = dest - 2sizeof(long) - old_top - 2sizeof(long)
&lt;/span>&lt;span class="cm">* req = dest - old_top - 4*sizeof(long)
&lt;/span>&lt;span class="cm">*/&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="bctf2016-bcloud">Bctf2016 bcloud&lt;/h2>
&lt;h3 id="ÂàÜÊûê">ÂàÜÊûê&lt;/h3>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">Arch: i386-32-little
RELRO: Partial RELRO
Stack: Canary found
NX: NX enabled
PIE: No PIE (0x8047000)
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>Á®ãÂ∫è‰∏ÄÂºÄÂßãËÆ©ËæìÂÖ•name„ÄÅorg„ÄÅhostnameÔºåËæìÂÖ•Â≠óÁ¨¶‰∏≤ÂáΩÊï∞Â≠òÂú®null byte overflow„ÄÇ&lt;/p>
&lt;p>ËæìÂÖ•nameÂáΩÊï∞‰∏≠ÔºåÂ≠óÁ¨¶‰∏≤Êï∞ÁªÑÂú®Ê†à‰∏≠ÂêéÈÉ®Á¥ßÈÇªÊåáÈíàÂèòÈáèÔºåÊâÄ‰ª•strcpy‰ºöÂ∞ÜËØ•ÊåáÈíà‰∏ÄÂπ∂Êã∑Ë¥ùÂÖ•0x40ÁöÑÁ©∫Èó¥ÔºàÂÆûÈôÖÂèØÁî®0x44ÔºâÔºåÂπ∂‰∏înull byteË¶ÜÁõñtopchunkÁöÑÊúÄ‰ΩéÂ≠óËäÇ„ÄÇÂèØ‰ª•Ê≥ÑÈú≤Â†ÜÁöÑÂú∞ÂùÄ&lt;/p>
&lt;p>ËæìÂÖ•org„ÄÅhostnameÂáΩÊï∞‰∏≠ÔºåÂ≠òÂú®ÂêåÊ†∑ÈóÆÈ¢òÔºåÂèØË¶ÜÁõñÁöÑÊõ¥Â§öÁöÑÂ≠óËäÇ„ÄÇÂèØ‰ª•Ë¶ÜÁõñtopchunkÁöÑsize&lt;/p></description></item><item><title>How2heap--overlapping_chunks Hack.lu2015--bookstore</title><link>https://hhdx.xyz/post/how2heap-overlapping-chunks-hack-lu2015-bookstore/</link><pubDate>Sun, 05 Jul 2020 18:45:39 +0000</pubDate><guid>https://hhdx.xyz/post/how2heap-overlapping-chunks-hack-lu2015-bookstore/</guid><description>&lt;h2 id="overlapping-chunks">overlapping chunks&lt;/h2>
&lt;p>Ê∫¢Âá∫ÂØπunsortedbin‰∏≠ÁöÑ&lt;code>chunk-&amp;gt;size&lt;/code>ËøõË°å‰øÆÊîπÔºåÈÄ†ÊàêÂ†ÜÂùóÈáçÂè†„ÄÇ&lt;/p>
&lt;h2 id="hacklu2015-bookstore">hack.lu2015 bookstore&lt;/h2>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">Arch: amd64-64-little
RELRO: No RELRO
Stack: Canary found
NX: NX enabled
PIE: No PIE (0x3ff000)
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>Á®ãÂ∫èÊòØ‰∏Ä‰∏™ËÆ¢‰π¶Á≥ªÁªüÔºåÂú®mainÂáΩÊï∞ÂºÄÂßãÂ§ÑÔºåËøûÁª≠ÂàÜÈÖç3‰∏™0x80ÁöÑÁ©∫Èó¥Ôºå‰∏Ä‰∏™Â≠òÂÇ®ËÆ¢Âçï1‚Äî‚Äîorder1Ôºå‰∏Ä‰∏™Â≠òÂÇ®ËÆ¢Âçï2‚Äî‚Äîorder2Ôºå‰∏Ä‰∏™Â≠òÂÇ®ÊèêÁ§∫‰ø°ÊÅØ‚Äî‚Äîinfo„ÄÇÊúâ‰ª•‰∏ãÂäüËÉΩËèúÂçï&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">1: Edit order 1
2: Edit order 2
3: Delete order 1
4: Delete order 2
5: Submit
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>Edit order 1/2Ôºöorder1/order2‰ΩøÁî®fgetcËØªÂèñÂ≠óÁ¨¶‰∏≤ÔºåËØªÂà∞&lt;code>\n&lt;/code>ÁªàÊ≠¢ÔºåÊâÄ‰ª•ËøôÈáåÂ≠òÂú®Ê∫¢Âá∫&lt;/p>
&lt;p>Delete order 1/2ÔºöfreeÊéâorder1/order2„ÄÇËøôÈáåÂ≠òÂú®ÊåáÈíàÊÇ¨Á©∫&lt;/p>
&lt;p>SubmitÔºö ÂàÜÈÖç0x140ÁöÑÁ©∫Èó¥ÔºàÁß∞‰∏∫orderlistÔºâÂ∞Üorder1Âíåorder2ÊãºÊé•„ÄÇËøôÈáåÂ≠òÂú®Ê∫¢Âá∫&lt;/p>
&lt;p>Á®ãÂ∫èÊú´Â∞æ&lt;code>printf(info)&lt;/code>Â≠òÂú®ÂèØËÉΩÁöÑÊ†ºÂºèÂåñÂ≠óÁ¨¶‰∏≤ÊºèÊ¥û„ÄÇ&lt;/p>
&lt;h3 id="overlapping-chunks--format-string-vulnerability">overlapping chunks &amp;amp;&amp;amp; format string vulnerability&lt;/h3></description></item><item><title>How2heap--poison_null_byte Plaidctf2015--plaiddb</title><link>https://hhdx.xyz/post/how2heap-poison-null-byte-plaidctf2015-plaiddb/</link><pubDate>Fri, 03 Jul 2020 00:16:56 +0000</pubDate><guid>https://hhdx.xyz/post/how2heap-poison-null-byte-plaidctf2015-plaiddb/</guid><description>&lt;h2 id="poison-null-byte">Poison null byte&lt;/h2>
&lt;p>ÂÖ≥‰∫éÂ†ÜÂùóÈáçÂè†ÔºåÂèØ‰ª•ÁúãËøôÁØá&lt;a href="https://4ngelboy.blogspot.com/2016/10/span-display-block-overflow-hidden_10.html">ÊñáÁ´†&lt;/a>ÔºåÂõæÊñáÂπ∂ËåÇ„ÄÇ&lt;/p>
&lt;p>glibc2.26‰∏≠ÔºåÂú®unlinkÂÆè‰∏≠Âä†ÂÖ•‰∫Ü&lt;code>size==prev_size(next_chunk)&lt;/code>ÁöÑÊ£ÄÊü•Ôºå‰∏é‰∏ã‰∏ÄchunkÊâÄÂ≠òÂÇ®ÁöÑpre_sizeËøõË°å‰∫ÜÊØîÂØπÔºåÂú®&lt;code>poison_null_byte.c&lt;/code>‰∏≠Áõ∏Â∫îÁöÑÊ∑ªÂä†‰∫Ü&lt;code>*(size_t*)(b+0x1f0) = 0x200&lt;/code>ÔºåÂèØ‰ª•ÁªïËøáËøô‰∏™Ê£ÄÊü•ÔºåÊâÄ‰ª•how2heapÁöÑREADME‰∏≠ÂØπglibcÁöÑË¶ÅÊ±ÇÊòØ&lt;code>&amp;lt;2.26&lt;/code>Â∫îËØ•ÊòØÂøò‰∫ÜÊîπ„ÄÇ&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">chunk b +------&amp;gt; +----------+
| |
+----------+ &amp;lt;---------+ size
| 0X200 |
+----------+ &amp;lt;---------+ b
| |
| |
| |
| |
| |
| |
| |
| |
| |
+----------+ &amp;lt;--------+ fake pre_size
| 0X200 |
+----------+
| |
chunk c +------&amp;gt; +----------+ &amp;lt;--------+ pre_size
| 0X210 |
+----------+
| |
| |
| |
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>&lt;strong>Ëß¶ÂèëunlinkÁöÑÊµÅÁ®ã&lt;/strong>ÔºöÈÄöËøánull byteÊ∫¢Âá∫‰º™ÈÄ†ÂÆå0x200ÁöÑchunkÂêéÔºåÊ≠§Êó∂ËØ•chunkÂ≠òÂú®‰∫éunsortedbin„ÄÇÂÜçÊ¨°ÂàÜÈÖç0x100ÁöÑb1Êó∂ÔºåÈÅçÂéÜunsortedbinÔºåËØ•chunkË¢´ÊîæÂÖ•Âà∞smallbin‰∏≠ÔºåunsortedbinÈáåÁöÑchunk‰πüÂ∞±Ëøô‰∏Ä‰∏™ÔºåÈÅçÂéÜÁªìÊùüÊó†Ê≥ïÂàÜÈÖç„ÄÇÂèàÈÄöËøáÊü•ÊâæbinmapÊâæÂà∞0x200ÁöÑsmallbinÔºåËøôÊó∂Ëß¶ÂèëÁöÑunlinkÔºåÂ∞ÜËØ•chunk‰ªésmallbin‰∏≠ÂèñÂá∫„ÄÇ&lt;/p></description></item><item><title>how2heap--House_of_Spirit Hack.lu2014--oreo</title><link>https://hhdx.xyz/post/how2heap-house-of-spirit-hacklu2014-oreo/</link><pubDate>Wed, 01 Jul 2020 14:13:34 +0000</pubDate><guid>https://hhdx.xyz/post/how2heap-house-of-spirit-hacklu2014-oreo/</guid><description>&lt;h2 id="house-of-spirit">House of Spirit&lt;/h2>
&lt;p>ËØ•ÊîªÂáªÊâãÊ≥ïÁöÑ‰∏ªË¶ÅÊòØÊÄùÊÉ≥ÊòØÔºåÂú®‰∏çÂèØÊéßÂå∫ÂüüÁöÑÂâçÂêé‰º™ÈÄ†chunk‰ø°ÊÅØÔºåË¶ÜÁõñÊüêÊåáÈíàÊåáÂêë&lt;code>chunk2mem(fake_chunk)&lt;/code>ÔºåÈáäÊîæËØ•ÊåáÈíàÂêéÂÜçÊ¨°Áî≥ËØ∑ÔºåÂØπ‰∏çÂèØÊéßÂå∫ÂüüÁöÑËøõË°åÊîπÂÜô„ÄÇ&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-fallback" data-lang="fallback">+---------------+
| ÂèØ Êéß Âå∫ Âüü |
+---------------+
| |
| ‰∏ç ÂèØ Êéß Âå∫ Âüü |
| |
| ‰∏Ä Ëà¨ ‰∏∫ Êüê ‰∫õ |
| Êåá Èíà |
+---------------+
| ÂèØ Êéß Âå∫ Âüü |
+---------------+
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>‰º™ÈÄ†ÁöÑchunk‰πüÈÄöÂ∏∏ÊòØfastbinÔºåÂõ†‰∏∫Ê£ÄÊü•ÂÆπÊòìÁªïËøá„ÄÇ&lt;/p></description></item><item><title>How2heap--fastbin_dup_consolidate Hitcon2016--SleepyHolder</title><link>https://hhdx.xyz/post/how2heap-fastbin-dup-consolidate-hitcon2016-sleepyholder/</link><pubDate>Sun, 28 Jun 2020 23:01:43 +0000</pubDate><guid>https://hhdx.xyz/post/how2heap-fastbin-dup-consolidate-hitcon2016-sleepyholder/</guid><description>&lt;h2 id="ÂâçÁΩÆ">ÂâçÁΩÆ&lt;/h2>
&lt;p>Ubuntu 16.04&lt;/p>
&lt;p>‰ΩøÁî®how2heapËÑöÊú¨ÁºñËØëglibc2.25ÔºåÂÖ∂‰∏≠ÁöÑ4ÊòØÁºñËØëÁ∫øÁ®ãÊï∞„ÄÇËÑöÊú¨‰∏≠&lt;code>git clone&lt;/code>ÊÖ¢ÔºåÂèØ‰ª•ÊõøÊç¢Êàê&lt;a href="https://mirrors.tuna.tsinghua.edu.cn/">tsinghua mirrors&lt;/a>ÔºåÊääÁ¨¨83Ë°åÁöÑ&lt;code>git clone git://sourceware.org/git/glibc.git &amp;quot;$SRC&amp;quot;&lt;/code> ÊõøÊç¢Êàê&lt;code> git clone https://mirrors.tuna.tsinghua.edu.cn/git/glibc.git &amp;quot;$SRC&amp;quot;&lt;/code>„ÄÇ&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">$ ./glibc_build.sh 2.25 -j &lt;span class="m">4&lt;/span> -disable-tcache
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>ÂÅöËøôÈÅìÈ¢òÁõÆ‰ΩøÁî®‰∫Üglibc2.25Ôºå&lt;code>patchelf --set-interpreter /path/to/ld-2.25.so /path/to/exe&lt;/code>Ôºåpatch‰πãÂêéÂÜçËøêË°åÁ®ãÂ∫èÂ∞±Ëá™Âä®‰ΩøÁî®ÂêåÁõÆÂΩï‰∏ãlibc-2.25.so„ÄÇ&lt;/p></description></item><item><title>glibc heap Êï¥ÁêÜ</title><link>https://hhdx.xyz/post/glibcheap/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://hhdx.xyz/post/glibcheap/</guid><description>&lt;p>ÁõÆÂâç Linux Ê†áÂáÜÂèëË°åÁâà‰∏≠‰ΩøÁî®ÁöÑÂ†ÜÂàÜÈÖçÂô®ÊòØ glibc ‰∏≠ÁöÑÂ†ÜÂàÜÈÖçÂô®Ôºöptmalloc2„ÄÇptmalloc2 ‰∏ªË¶ÅÊòØÈÄöËøá malloc/free ÂáΩÊï∞Êù•ÂàÜÈÖçÂíåÈáäÊîæÂÜÖÂ≠òÂùó„ÄÇ&lt;/p>
&lt;p>ÈúÄË¶ÅÊ≥®ÊÑèÁöÑÊòØÔºåÂú®ÂÜÖÂ≠òÂàÜÈÖç‰∏é‰ΩøÁî®ÁöÑËøáÁ®ã‰∏≠ÔºåLinux ÊúâËøôÊ†∑ÁöÑ‰∏Ä‰∏™Âü∫Êú¨ÂÜÖÂ≠òÁÆ°ÁêÜÊÄùÊÉ≥Ôºå&lt;strong>Âè™ÊúâÂΩìÁúüÊ≠£ËÆøÈóÆ‰∏Ä‰∏™Âú∞ÂùÄÁöÑÊó∂ÂÄôÔºåÁ≥ªÁªüÊâç‰ºöÂª∫Á´ãËôöÊãüÈ°µÈù¢‰∏éÁâ©ÁêÜÈ°µÈù¢ÁöÑÊò†Â∞ÑÂÖ≥Á≥ª&lt;/strong>„ÄÇ&lt;/p>
&lt;h2 id="Âü∫Êú¨Êìç‰Ωú">Âü∫Êú¨Êìç‰Ωú&lt;/h2>
&lt;h3 id="malloc">malloc&lt;/h3>
&lt;p>&lt;code>malloc(size_t n)&lt;/code>&lt;/p>
&lt;ul>
&lt;li>ÂΩì n=0 Êó∂ÔºåËøîÂõûÂΩìÂâçÁ≥ªÁªüÂÖÅËÆ∏ÁöÑÂ†ÜÁöÑÊúÄÂ∞èÂÜÖÂ≠òÂùó„ÄÇ&lt;/li>
&lt;li>ÂΩì n ‰∏∫Ë¥üÊï∞Êó∂ÔºåÁî±‰∫éÂú®Â§ßÂ§öÊï∞Á≥ªÁªü‰∏äÔºå&lt;strong>size_t ÊòØÊó†Á¨¶Âè∑Êï∞ÔºàËøô‰∏ÄÁÇπÈùûÂ∏∏ÈáçË¶ÅÔºâ&lt;/strong>ÔºåÊâÄ‰ª•Á®ãÂ∫èÂ∞±‰ºöÁî≥ËØ∑ÂæàÂ§ßÁöÑÂÜÖÂ≠òÁ©∫Èó¥Ôºå‰ΩÜÈÄöÂ∏∏Êù•ËØ¥ÈÉΩ‰ºöÂ§±Ë¥•ÔºåÂõ†‰∏∫Á≥ªÁªüÊ≤°ÊúâÈÇ£‰πàÂ§öÁöÑÂÜÖÂ≠òÂèØ‰ª•ÂàÜÈÖç„ÄÇ&lt;/li>
&lt;/ul>
&lt;h3 id="free">free&lt;/h3>
&lt;p>&lt;code>free(void *p)&lt;/code>&lt;/p>
&lt;ul>
&lt;li>&lt;strong>ÂΩì p ‰∏∫Á©∫ÊåáÈíàÊó∂ÔºåÂáΩÊï∞‰∏çÊâßË°å‰ªª‰ΩïÊìç‰Ωú„ÄÇ&lt;/strong>&lt;/li>
&lt;li>ÂΩì p Â∑≤ÁªèË¢´ÈáäÊîæ‰πãÂêéÔºåÂÜçÊ¨°ÈáäÊîæ‰ºöÂá∫Áé∞‰π±‰∏ÉÂÖ´Á≥üÁöÑÊïàÊûúÔºåËøôÂÖ∂ÂÆûÂ∞±ÊòØ &lt;code>double free&lt;/code>„ÄÇ&lt;/li>
&lt;li>Èô§‰∫ÜË¢´Á¶ÅÁî® (mallopt) ÁöÑÊÉÖÂÜµ‰∏ãÔºåÂΩìÈáäÊîæÂæàÂ§ßÁöÑÂÜÖÂ≠òÁ©∫Èó¥Êó∂ÔºåÁ®ãÂ∫è‰ºöÂ∞ÜËøô‰∫õÂÜÖÂ≠òÁ©∫Èó¥ËøòÁªôÁ≥ªÁªüÔºå‰ª•‰æø‰∫éÂáèÂ∞èÁ®ãÂ∫èÊâÄ‰ΩøÁî®ÁöÑÂÜÖÂ≠òÁ©∫Èó¥„ÄÇ&lt;/li>
&lt;/ul>
&lt;h2 id="ËÉåÂêéÁöÑÁ≥ªÁªüË∞ÉÁî®">ËÉåÂêéÁöÑÁ≥ªÁªüË∞ÉÁî®&lt;/h2>
&lt;p>Ëøô‰∫õÂáΩÊï∞ËÉåÂêéÁöÑÁ≥ªÁªüË∞ÉÁî®‰∏ªË¶ÅÊòØ &lt;a href="http://man7.org/linux/man-pages/man2/sbrk.2.html">(s)brk&lt;/a> ÂáΩÊï∞‰ª•Âèä &lt;a href="http://man7.org/linux/man-pages/man2/mmap.2.html">mmap, munmap&lt;/a> ÂáΩÊï∞„ÄÇ&lt;/p></description></item></channel></rss>